<script src="{{ asset('assets/article/article-editor.min.js', 'public') }}"></script>
<link rel="stylesheet" href="{{ asset('assets/article/css/article-editor.min.css', 'public') }}">

{% set settings = article_settings()|json_decode() %}
{% if settings.draggable_menu is defined and settings.draggable_menu is not empty %}
    <link rel="stylesheet" href="{{ asset(settings.draggable_menu.css, 'public') }}">
    <script src="{{ asset(settings.draggable_menu.js, 'public') }}">
{% endif %}

{{ article_includes() }}
<script>
ArticleEditor.settings = {
    callbacks: {
        image: {
            uploadError: function(response)
            {
                alert(response.message);
            }
        },
        file: {
            uploadError: function(response)
            {
                alert(response.message);
            }
        }
    }
};

function initArticles() {
    ArticleEditor('.article-field', {{ article_settings() }});
}

$(document).on('DOMNodeInserted', function(e) {
    if ( $(e.target).hasClass('collection-item') ) {
        initArticles();
    }
});

initArticles();

</script>
