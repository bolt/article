ArticleEditor.add("plugin","buttonlink",{translations:{en:{buttonlink:{button:"Button"}}},defaults:{classname:!1},subscribe:{"popup.before.open":function(){if(!1!==this.opts.buttonlink.classname){var t=this.app.popup.getStack();"link"===t.getName()&&this._build(t)}}},make:function(){this.app.popup.close(),this.app.link.getLink().addClass(this.opts.buttonlink.classname)},unmake:function(){this.app.popup.close(),this.app.link.getLink().removeClass(this.opts.buttonlink.classname)},_build:function(t){var n=this.app.link.getLink();if(0!==n.length){var s=t.getItemsData(),i={title:"## buttonlink.button ##",command:"buttonlink.make"},a=this.app.utils.getObjectIndex(s,"unlink");this._hasClass(n)&&(i={title:"## buttonlink.button ##",command:"buttonlink.unmake",active:!0}),s=this.app.utils.insertToObject("buttonlink",i,s,a),t.setItemsData(s)}},_hasClass:function(t){for(var n=this.opts.buttonlink.classname.split(" "),s=0,i=0;i<n.length;i++)t.hasClass(n[i])&&s++;return s===n.length}});